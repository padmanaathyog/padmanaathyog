# Yoga Website with Supabase Integration

This project is a comprehensive website for a yoga instructor, featuring an admin dashboard for content management. The data layer is managed by Supabase, providing a seamless experience for managing testimonials, gallery items, events, and more.

## Features

- **Responsive Design**: Fully responsive design that works on all devices
- **Admin Dashboard**: Secure admin area for content management
- **Gallery Management**: Upload and organize images and videos
- **Event Management**: Create and manage upcoming and past events
- **Testimonial System**: Showcase student reviews and testimonials
- **Blog Integration**: Prepared for future external blog provider integration
- **Type Safety**: Comprehensive TypeScript integration with Supabase
- **Pagination**: Efficient data loading with pagination across all content types
- **Error Handling**: Robust error handling with user-friendly messages

## Getting Started

### Prerequisites

- Node.js 16.x or higher
- npm or yarn
- A Supabase account (free tier is sufficient for getting started)

### Setting Up Supabase

1. Create a new Supabase project at [https://supabase.com](https://supabase.com)
2. Set up the following tables in your Supabase database:

#### testimonials
\`\`\`sql
create table public.testimonials (
  id bigint generated by default as identity primary key,
  created_at timestamp with time zone default now() not null,
  updated_at timestamp with time zone default now() not null,
  name text not null,
  role text not null,
  quote text not null,
  image text not null,
  rating integer not null
);
\`\`\`

#### gallery_images
\`\`\`sql
create table public.gallery_images (
  id bigint generated by default as identity primary key,
  created_at timestamp with time zone default now() not null,
  updated_at timestamp with time zone default now() not null,
  title text not null,
  description text not null,
  src text not null,
  category text not null
);
\`\`\`

#### gallery_videos
\`\`\`sql
create table public.gallery_videos (
  id bigint generated by default as identity primary key,
  created_at timestamp with time zone default now() not null,
  updated_at timestamp with time zone default now() not null,
  title text not null,
  description text not null,
  src text not null,
  thumbnail text not null,
  duration text not null,
  category text not null
);
\`\`\`

#### events
\`\`\`sql
create table public.events (
  id bigint generated by default as identity primary key,
  created_at timestamp with time zone default now() not null,
  updated_at timestamp with time zone default now() not null,
  title text not null,
  description text not null,
  image text not null,
  date text not null,
  time text not null,
  location text not null,
  price text not null,
  spots integer not null,
  is_past boolean default false not null
);
\`\`\`

#### blog_external_refs
\`\`\`sql
create table public.blog_external_refs (
  id bigint generated by default as identity primary key,
  created_at timestamp with time zone default now() not null,
  updated_at timestamp with time zone default now() not null,
  external_id text not null,
  title text not null,
  excerpt text not null,
  image text not null,
  author text not null,
  date text not null,
  slug text not null unique,
  provider text not null
);
\`\`\`

3. Create a storage bucket named `yoga-images` for storing images and thumbnails

4. Set up authentication in Supabase:
   - Enable Email/Password authentication
   - Create an admin user through the Supabase dashboard

### Environment Variables

Copy the `.env.local.example` file to `.env.local` and fill in your Supabase credentials:

\`\`\`bash
cp .env.local.example .env.local
\`\`\`

Then update the values in `.env.local` with your Supabase project URL and anon key.

### Installation

\`\`\`bash
# Install dependencies
npm install

# Run the development server
npm run dev
\`\`\`

## Supabase Free Tier Limitations and Optimizations

The free tier of Supabase has some limitations to be aware of:

- **Storage**: 1GB of storage for files
- **Database**: 500MB of database storage
- **Bandwidth**: 2GB of transfer per month
- **Auth**: 50,000 monthly active users
- **Edge Functions**: 500,000 invocations per month

### Optimizations Implemented

To work within these limitations, the application includes:

1. **Pagination**: All data is paginated to reduce database load and bandwidth usage
2. **Image Optimization**: Images are optimized before upload to reduce storage usage
3. **Caching**: API responses are cached where appropriate to reduce database queries
4. **Error Handling**: Robust error handling for rate limiting and other potential issues
5. **Lazy Loading**: Images and content are lazy-loaded to reduce initial bandwidth usage

## Admin Dashboard

The admin dashboard is accessible at `/admin-dashboard`. You'll need to log in with the admin credentials you set up in Supabase.

The dashboard allows you to:

- Manage testimonials
- Upload and organize gallery images and videos
- Create and edit events
- Prepare blog content for future external integration

## Blog Functionality

The blog functionality is prepared for future integration with an external provider. Currently, it stores references to external blog posts in Supabase, which can be easily migrated to a full external provider in the future.

## Environment Variables and Secrets

The application requires the following environment variables to function correctly:

- `NEXT_PUBLIC_SUPABASE_URL`: Your Supabase project URL
- `NEXT_PUBLIC_SUPABASE_ANON_KEY`: Your Supabase anonymous key

These variables can be added directly to your `.env.local` file for local development, or to your deployment platform's environment variables for production.

**Important**: When adding secrets directly to the `.env.local` file, the application will work fully as long as all required variables are provided. However, for production deployments, it's recommended to use your hosting platform's environment variable management system for better security.

## Troubleshooting

### Common Issues

1. **Authentication Issues**: Make sure your Supabase URL and anon key are correct in your `.env.local` file.

2. **Storage Issues**: If you're having trouble uploading images, check that your storage bucket is properly configured and that you have the correct permissions.

3. **CORS Issues**: If you're experiencing CORS errors, make sure your Supabase project has the correct CORS configuration.

4. **Rate Limiting**: If you're hitting rate limits on the free tier, consider implementing more aggressive caching or optimizing your queries.

### Getting Help

If you encounter any issues, please check the [Supabase documentation](https://supabase.com/docs) or open an issue in this repository.
\`\`\`

Let's update the supabase.ts file with better error handling:
